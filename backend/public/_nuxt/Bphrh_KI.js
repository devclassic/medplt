import{s as W,e as X,_ as oe,a4 as ce,b as ie,d as fe,w as de}from"./vbLTN4dk.js";import{i as Ee}from"./5xU2jYLy.js";import{D as A,E as K,H,A as se,C as U,P as w,k as m,q as z,$ as le,Y as ve,z as pe,o as Te,aA as me,T as I,a0 as D}from"./C-lO5xe2.js";import{E as re}from"./DJ49jiU5.js";const k="focus-trap.focus-after-trapped",P="focus-trap.focus-after-released",_e="focus-trap.focusout-prevented",J={cancelable:!0,bubbles:!1},Se={cancelable:!0,bubbles:!1},g="focusAfterTrapped",Q="focusAfterReleased",be=Symbol("elFocusTrap"),B=A(),y=A(0),Y=A(0);let _=0;const ue=e=>{const o=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const u=t.tagName==="INPUT"&&t.type==="hidden";return t.disabled||t.hidden||u?NodeFilter.FILTER_SKIP:t.tabIndex>=0||t===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)o.push(s.currentNode);return o},Z=(e,o)=>{for(const s of e)if(!Le(s,o))return s},Le=(e,o)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(o&&e===o)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},Ae=e=>{const o=ue(e),s=Z(o,e),t=Z(o.reverse(),e);return[s,t]},ye=e=>e instanceof HTMLInputElement&&"select"in e,E=(e,o)=>{if(e&&e.focus){const s=document.activeElement;let t=!1;W(e)&&!Ee(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),t=!0),e.focus({preventScroll:!0}),Y.value=window.performance.now(),e!==s&&ye(e)&&o&&e.select(),W(e)&&t&&e.removeAttribute("tabindex")}};function h(e,o){const s=[...e],t=e.indexOf(o);return t!==-1&&s.splice(t,1),s}const Ce=()=>{let e=[];return{push:t=>{const u=e[0];u&&t!==u&&u.pause(),e=h(e,t),e.unshift(t)},remove:t=>{var u,f;e=h(e,t),(f=(u=e[0])==null?void 0:u.resume)==null||f.call(u)}}},Ne=(e,o=!1)=>{const s=document.activeElement;for(const t of e)if(E(t,o),document.activeElement!==s)return},ee=Ce(),Re=()=>y.value>Y.value,S=()=>{B.value="pointer",y.value=window.performance.now()},te=()=>{B.value="keyboard",y.value=window.performance.now()},Fe=()=>(K(()=>{_===0&&(document.addEventListener("mousedown",S),document.addEventListener("touchstart",S),document.addEventListener("keydown",te)),_++}),H(()=>{_--,_<=0&&(document.removeEventListener("mousedown",S),document.removeEventListener("touchstart",S),document.removeEventListener("keydown",te))}),{focusReason:B,lastUserFocusTimestamp:y,lastAutomatedFocusTimestamp:Y}),b=e=>new CustomEvent(_e,{...Se,detail:e});let v=[];const ne=e=>{e.code===re.esc&&v.forEach(o=>o(e))},Oe=e=>{K(()=>{v.length===0&&document.addEventListener("keydown",ne),X&&v.push(e)}),H(()=>{v=v.filter(o=>o!==e),v.length===0&&X&&document.removeEventListener("keydown",ne)})},we=se({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[g,Q,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:o}){const s=A();let t,u;const{focusReason:f}=Fe();Oe(n=>{e.trapped&&!l.paused&&o("release-requested",n)});const l={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=n=>{if(!e.loop&&!e.trapped||l.paused)return;const{code:r,altKey:a,ctrlKey:c,metaKey:i,currentTarget:G,shiftKey:q}=n,{loop:j}=e,ae=r===re.tab&&!a&&!c&&!i,T=document.activeElement;if(ae&&T){const R=G,[F,O]=Ae(R);if(F&&O){if(!q&&T===O){const d=b({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||(n.preventDefault(),j&&E(F,!0))}else if(q&&[F,R].includes(T)){const d=b({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||(n.preventDefault(),j&&E(O,!0))}}else if(T===R){const d=b({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||n.preventDefault()}}};ve(be,{focusTrapRef:s,onKeydown:p}),w(()=>e.focusTrapEl,n=>{n&&(s.value=n)},{immediate:!0}),w([s],([n],[r])=>{n&&(n.addEventListener("keydown",p),n.addEventListener("focusin",C),n.addEventListener("focusout",N)),r&&(r.removeEventListener("keydown",p),r.removeEventListener("focusin",C),r.removeEventListener("focusout",N))});const M=n=>{o(g,n)},$=n=>o(Q,n),C=n=>{const r=m(s);if(!r)return;const a=n.target,c=n.relatedTarget,i=a&&r.contains(a);e.trapped||c&&r.contains(c)||(t=c),i&&o("focusin",n),!l.paused&&e.trapped&&(i?u=a:E(u,!0))},N=n=>{const r=m(s);if(!(l.paused||!r))if(e.trapped){const a=n.relatedTarget;!ce(a)&&!r.contains(a)&&setTimeout(()=>{if(!l.paused&&e.trapped){const c=b({focusReason:f.value});o("focusout-prevented",c),c.defaultPrevented||E(u,!0)}},0)}else{const a=n.target;a&&r.contains(a)||o("focusout",n)}};async function V(){await z();const n=m(s);if(n){ee.push(l);const r=n.contains(document.activeElement)?t:document.activeElement;if(t=r,!n.contains(r)){const c=new Event(k,J);n.addEventListener(k,M),n.dispatchEvent(c),c.defaultPrevented||z(()=>{let i=e.focusStartEl;le(i)||(E(i),document.activeElement!==i&&(i="first")),i==="first"&&Ne(ue(n),!0),(document.activeElement===r||i==="container")&&E(n)})}}}function x(){const n=m(s);if(n){n.removeEventListener(k,M);const r=new CustomEvent(P,{...J,detail:{focusReason:f.value}});n.addEventListener(P,$),n.dispatchEvent(r),!r.defaultPrevented&&(f.value=="keyboard"||!Re()||n.contains(document.activeElement))&&E(t??document.body),n.removeEventListener(P,$),ee.remove(l)}}return K(()=>{e.trapped&&V(),w(()=>e.trapped,n=>{n?V():x()})}),H(()=>{e.trapped&&x(),s.value&&(s.value.removeEventListener("keydown",p),s.value.removeEventListener("focusin",C),s.value.removeEventListener("focusout",N),s.value=void 0)}),{onKeydown:p}}});function Ie(e,o,s,t,u,f){return U(e.$slots,"default",{handleKeydown:e.onKeydown})}var $e=oe(we,[["render",Ie],["__file","focus-trap.vue"]]);const De=ie({to:{type:fe([String,Object]),required:!0},disabled:Boolean}),ke=se({__name:"teleport",props:De,setup(e){return(o,s)=>o.disabled?U(o.$slots,"default",{key:0}):(Te(),pe(me,{key:1,to:o.to},[U(o.$slots,"default")],8,["to"]))}});var Pe=oe(ke,[["__file","teleport.vue"]]);const Ve=de(Pe);var Ue=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Ue||{});const L=e=>{const o=I(e)?e:[e],s=[];return o.forEach(t=>{var u;I(t)?s.push(...L(t)):D(t)&&((u=t.component)!=null&&u.subTree)?s.push(t,...L(t.component.subTree)):D(t)&&I(t.children)?s.push(...L(t.children)):D(t)&&t.shapeFlag===2?s.push(...L(t.type())):s.push(t)}),s};export{$e as E,be as F,Ue as P,Ve as a,E as b,L as f,De as t};
