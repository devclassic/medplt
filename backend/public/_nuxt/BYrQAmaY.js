import{s as J,e as W,_ as oe,a4 as ce,b as ie,d as fe,w as de}from"./CVOtDZBH.js";import{i as le}from"./daoBXWbk.js";import{z as y,H as K,J as B,D as se,G as P,Q as w,k as m,q as X,a0 as Ee,Z as ve,C as pe,o as Te,aB as me,U as I,a1 as D}from"./EwCbqKW-.js";import{E as re}from"./DJ49jiU5.js";const k="focus-trap.focus-after-trapped",U="focus-trap.focus-after-released",_e="focus-trap.focusout-prevented",z={cancelable:!0,bubbles:!1},Se={cancelable:!0,bubbles:!1},Q="focusAfterTrapped",Z="focusAfterReleased",be=Symbol("elFocusTrap"),H=y(),A=y(0),M=y(0);let _=0;const ue=e=>{const o=[],s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{const u=t.tagName==="INPUT"&&t.type==="hidden";return t.disabled||t.hidden||u?NodeFilter.FILTER_SKIP:t.tabIndex>=0||t===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)o.push(s.currentNode);return o},g=(e,o)=>{for(const s of e)if(!Le(s,o))return s},Le=(e,o)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(o&&e===o)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},ye=e=>{const o=ue(e),s=g(o,e),t=g(o.reverse(),e);return[s,t]},Ae=e=>e instanceof HTMLInputElement&&"select"in e,l=(e,o)=>{if(e&&e.focus){const s=document.activeElement;let t=!1;J(e)&&!le(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),t=!0),e.focus({preventScroll:!0}),M.value=window.performance.now(),e!==s&&Ae(e)&&o&&e.select(),J(e)&&t&&e.removeAttribute("tabindex")}};function h(e,o){const s=[...e],t=e.indexOf(o);return t!==-1&&s.splice(t,1),s}const Ce=()=>{let e=[];return{push:t=>{const u=e[0];u&&t!==u&&u.pause(),e=h(e,t),e.unshift(t)},remove:t=>{var u,f;e=h(e,t),(f=(u=e[0])==null?void 0:u.resume)==null||f.call(u)}}},Ne=(e,o=!1)=>{const s=document.activeElement;for(const t of e)if(l(t,o),document.activeElement!==s)return},ee=Ce(),Re=()=>A.value>M.value,S=()=>{H.value="pointer",A.value=window.performance.now()},te=()=>{H.value="keyboard",A.value=window.performance.now()},Fe=()=>(K(()=>{_===0&&(document.addEventListener("mousedown",S),document.addEventListener("touchstart",S),document.addEventListener("keydown",te)),_++}),B(()=>{_--,_<=0&&(document.removeEventListener("mousedown",S),document.removeEventListener("touchstart",S),document.removeEventListener("keydown",te))}),{focusReason:H,lastUserFocusTimestamp:A,lastAutomatedFocusTimestamp:M}),b=e=>new CustomEvent(_e,{...Se,detail:e});let v=[];const ne=e=>{e.code===re.esc&&v.forEach(o=>o(e))},Oe=e=>{K(()=>{v.length===0&&document.addEventListener("keydown",ne),W&&v.push(e)}),B(()=>{v=v.filter(o=>o!==e),v.length===0&&W&&document.removeEventListener("keydown",ne)})},we=se({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Q,Z,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:o}){const s=y();let t,u;const{focusReason:f}=Fe();Oe(n=>{e.trapped&&!E.paused&&o("release-requested",n)});const E={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=n=>{if(!e.loop&&!e.trapped||E.paused)return;const{code:r,altKey:a,ctrlKey:c,metaKey:i,currentTarget:x,shiftKey:q}=n,{loop:j}=e,ae=r===re.tab&&!a&&!c&&!i,T=document.activeElement;if(ae&&T){const R=x,[F,O]=ye(R);if(F&&O){if(!q&&T===O){const d=b({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||(n.preventDefault(),j&&l(F,!0))}else if(q&&[F,R].includes(T)){const d=b({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||(n.preventDefault(),j&&l(O,!0))}}else if(T===R){const d=b({focusReason:f.value});o("focusout-prevented",d),d.defaultPrevented||n.preventDefault()}}};ve(be,{focusTrapRef:s,onKeydown:p}),w(()=>e.focusTrapEl,n=>{n&&(s.value=n)},{immediate:!0}),w([s],([n],[r])=>{n&&(n.addEventListener("keydown",p),n.addEventListener("focusin",C),n.addEventListener("focusout",N)),r&&(r.removeEventListener("keydown",p),r.removeEventListener("focusin",C),r.removeEventListener("focusout",N))});const Y=n=>{o(Q,n)},V=n=>o(Z,n),C=n=>{const r=m(s);if(!r)return;const a=n.target,c=n.relatedTarget,i=a&&r.contains(a);e.trapped||c&&r.contains(c)||(t=c),i&&o("focusin",n),!E.paused&&e.trapped&&(i?u=a:l(u,!0))},N=n=>{const r=m(s);if(!(E.paused||!r))if(e.trapped){const a=n.relatedTarget;!ce(a)&&!r.contains(a)&&setTimeout(()=>{if(!E.paused&&e.trapped){const c=b({focusReason:f.value});o("focusout-prevented",c),c.defaultPrevented||l(u,!0)}},0)}else{const a=n.target;a&&r.contains(a)||o("focusout",n)}};async function $(){await X();const n=m(s);if(n){ee.push(E);const r=n.contains(document.activeElement)?t:document.activeElement;if(t=r,!n.contains(r)){const c=new Event(k,z);n.addEventListener(k,Y),n.dispatchEvent(c),c.defaultPrevented||X(()=>{let i=e.focusStartEl;Ee(i)||(l(i),document.activeElement!==i&&(i="first")),i==="first"&&Ne(ue(n),!0),(document.activeElement===r||i==="container")&&l(n)})}}}function G(){const n=m(s);if(n){n.removeEventListener(k,Y);const r=new CustomEvent(U,{...z,detail:{focusReason:f.value}});n.addEventListener(U,V),n.dispatchEvent(r),!r.defaultPrevented&&(f.value=="keyboard"||!Re()||n.contains(document.activeElement))&&l(t??document.body),n.removeEventListener(U,V),ee.remove(E)}}return K(()=>{e.trapped&&$(),w(()=>e.trapped,n=>{n?$():G()})}),B(()=>{e.trapped&&G(),s.value&&(s.value.removeEventListener("keydown",p),s.value.removeEventListener("focusin",C),s.value.removeEventListener("focusout",N),s.value=void 0)}),{onKeydown:p}}});function Ie(e,o,s,t,u,f){return P(e.$slots,"default",{handleKeydown:e.onKeydown})}var Ve=oe(we,[["render",Ie],["__file","focus-trap.vue"]]);const De=ie({to:{type:fe([String,Object]),required:!0},disabled:Boolean}),ke=se({__name:"teleport",props:De,setup(e){return(o,s)=>o.disabled?P(o.$slots,"default",{key:0}):(Te(),pe(me,{key:1,to:o.to},[P(o.$slots,"default")],8,["to"]))}});var Ue=oe(ke,[["__file","teleport.vue"]]);const $e=de(Ue);var Pe=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(Pe||{});const L=e=>{const o=I(e)?e:[e],s=[];return o.forEach(t=>{var u;I(t)?s.push(...L(t)):D(t)&&((u=t.component)!=null&&u.subTree)?s.push(t,...L(t.component.subTree)):D(t)&&I(t.children)?s.push(...L(t.children)):D(t)&&t.shapeFlag===2?s.push(...L(t.type())):s.push(t)}),s};export{Ve as E,be as F,Pe as P,$e as a,l as b,L as f,De as t};
