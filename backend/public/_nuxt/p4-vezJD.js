import{D,G as I,a2 as B,a6 as H,x as y,O as te,U as K,X as ae,K as k,k as m,p as j,B as ce,Q as ie,o as fe,aD as de}from"#entry";import{f as le}from"./C4gErKuu.js";import{k as X,_ as ne,a3 as Ee,p as ve,q as pe,w as Te}from"./CEbQVcMT.js";import{g as oe,E as se}from"./CBheTNdn.js";var me=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(me||{});const _=e=>{const s=D(e)?e:[e],o=[];return s.forEach(n=>{var u;D(n)?o.push(..._(n)):I(n)&&((u=n.component)!=null&&u.subTree)?o.push(n,..._(n.component.subTree)):I(n)&&D(n.children)?o.push(..._(n.children)):I(n)&&n.shapeFlag===2?o.push(..._(n.type())):o.push(n)}),o},U="focus-trap.focus-after-trapped",P="focus-trap.focus-after-released",_e="focus-trap.focusout-prevented",W={cancelable:!0,bubbles:!1},Se={cancelable:!0,bubbles:!1},g="focusAfterTrapped",J="focusAfterReleased",Le=Symbol("elFocusTrap"),M=y(),A=y(0),Y=y(0);let S=0;const re=e=>{const s=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const u=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||u?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)s.push(o.currentNode);return s},Q=(e,s)=>{for(const o of e)if(!be(o,s))return o},be=(e,s)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(s&&e===s)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},ye=e=>{const s=re(e),o=Q(s,e),n=Q(s.reverse(),e);return[o,n]},Ae=e=>e instanceof HTMLInputElement&&"select"in e,l=(e,s)=>{if(e){const o=document.activeElement;le(e,{preventScroll:!0}),Y.value=window.performance.now(),e!==o&&Ae(e)&&s&&e.select()}};function z(e,s){const o=[...e],n=e.indexOf(s);return n!==-1&&o.splice(n,1),o}const Ce=()=>{let e=[];return{push:n=>{const u=e[0];u&&n!==u&&u.pause(),e=z(e,n),e.unshift(n)},remove:n=>{var u,f;e=z(e,n),(f=(u=e[0])==null?void 0:u.resume)==null||f.call(u)}}},Ne=(e,s=!1)=>{const o=document.activeElement;for(const n of e)if(l(n,s),document.activeElement!==o)return},Z=Ce(),Oe=()=>A.value>Y.value,L=()=>{M.value="pointer",A.value=window.performance.now()},h=()=>{M.value="keyboard",A.value=window.performance.now()},Re=()=>(B(()=>{S===0&&(document.addEventListener("mousedown",L),document.addEventListener("touchstart",L),document.addEventListener("keydown",h)),S++}),H(()=>{S--,S<=0&&(document.removeEventListener("mousedown",L),document.removeEventListener("touchstart",L),document.removeEventListener("keydown",h))}),{focusReason:M,lastUserFocusTimestamp:A,lastAutomatedFocusTimestamp:Y}),b=e=>new CustomEvent(_e,{...Se,detail:e});let v=[];const ee=e=>{oe(e)===se.esc&&v.forEach(o=>o(e))},Fe=e=>{B(()=>{v.length===0&&document.addEventListener("keydown",ee),X&&v.push(e)}),H(()=>{v=v.filter(s=>s!==e),v.length===0&&X&&document.removeEventListener("keydown",ee)})},we=te({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[g,J,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:s}){const o=y();let n,u;const{focusReason:f}=Re();Fe(t=>{e.trapped&&!E.paused&&s("release-requested",t)});const E={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},p=t=>{if(!e.loop&&!e.trapped||E.paused)return;const{altKey:r,ctrlKey:a,metaKey:c,currentTarget:i,shiftKey:O}=t,{loop:x}=e,ue=oe(t)===se.tab&&!r&&!a&&!c,T=document.activeElement;if(ue&&T){const R=i,[F,w]=ye(R);if(F&&w){if(!O&&T===w){const d=b({focusReason:f.value});s("focusout-prevented",d),d.defaultPrevented||(t.preventDefault(),x&&l(F,!0))}else if(O&&[F,R].includes(T)){const d=b({focusReason:f.value});s("focusout-prevented",d),d.defaultPrevented||(t.preventDefault(),x&&l(w,!0))}}else if(T===R){const d=b({focusReason:f.value});s("focusout-prevented",d),d.defaultPrevented||t.preventDefault()}}};ae(Le,{focusTrapRef:o,onKeydown:p}),k(()=>e.focusTrapEl,t=>{t&&(o.value=t)},{immediate:!0}),k([o],([t],[r])=>{t&&(t.addEventListener("keydown",p),t.addEventListener("focusin",C),t.addEventListener("focusout",N)),r&&(r.removeEventListener("keydown",p),r.removeEventListener("focusin",C),r.removeEventListener("focusout",N))});const V=t=>{s(g,t)},$=t=>s(J,t),C=t=>{const r=m(o);if(!r)return;const a=t.target,c=t.relatedTarget,i=a&&r.contains(a);e.trapped||c&&r.contains(c)||(n=c),i&&s("focusin",t),!E.paused&&e.trapped&&(i?u=a:l(u,!0))},N=t=>{const r=m(o);if(!(E.paused||!r))if(e.trapped){const a=t.relatedTarget;!Ee(a)&&!r.contains(a)&&setTimeout(()=>{if(!E.paused&&e.trapped){const c=b({focusReason:f.value});s("focusout-prevented",c),c.defaultPrevented||l(u,!0)}},0)}else{const a=t.target;a&&r.contains(a)||s("focusout",t)}};async function G(){await j();const t=m(o);if(t){Z.push(E);const r=t.contains(document.activeElement)?n:document.activeElement;if(n=r,!t.contains(r)){const c=new Event(U,W);t.addEventListener(U,V),t.dispatchEvent(c),c.defaultPrevented||j(()=>{let i=e.focusStartEl;ce(i)||(l(i),document.activeElement!==i&&(i="first")),i==="first"&&Ne(re(t),!0),(document.activeElement===r||i==="container")&&l(t)})}}}function q(){const t=m(o);if(t){t.removeEventListener(U,V);const r=new CustomEvent(P,{...W,detail:{focusReason:f.value}});t.addEventListener(P,$),t.dispatchEvent(r),!r.defaultPrevented&&(f.value=="keyboard"||!Oe()||t.contains(document.activeElement))&&l(n??document.body),t.removeEventListener(P,$),Z.remove(E),n=null,u=null}}return B(()=>{e.trapped&&G(),k(()=>e.trapped,t=>{t?G():q()})}),H(()=>{e.trapped&&q(),o.value&&(o.value.removeEventListener("keydown",p),o.value.removeEventListener("focusin",C),o.value.removeEventListener("focusout",N),o.value=void 0)}),{onKeydown:p}}});function De(e,s,o,n,u,f){return K(e.$slots,"default",{handleKeydown:e.onKeydown})}var Ve=ne(we,[["render",De],["__file","focus-trap.vue"]]);const Ie=ve({to:{type:pe([String,Object]),required:!0},disabled:Boolean}),ke=te({__name:"teleport",props:Ie,setup(e){return(s,o)=>s.disabled?K(s.$slots,"default",{key:0}):(fe(),ie(de,{key:1,to:s.to},[K(s.$slots,"default")],8,["to"]))}});var Ue=ne(ke,[["__file","teleport.vue"]]);const $e=Te(Ue);export{Ve as E,Le as F,me as P,$e as a,_ as f,Ie as t};
